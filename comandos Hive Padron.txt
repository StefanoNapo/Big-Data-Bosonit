CREATE TABLE IF NOT EXISTS student_copy 
(COD_DISTRITO INT, DESC_DISTRITO STRING,COD_DIST_BARRIO INT, DESC_BARRIO STRING, COD_BARRIO INT,
COD_DIST_SECCION INT, COD_SECCION INT, COD_EDAD_INT INT, ESPANOLESHOMBRES INT, ESPANOLESMUJERES INT,
EXTRANJEROSHOMBRES INT,EXTRANJEROSMUJERES INT,FX_CARGA DATE, FX_DATOS_INI DATE, FX_DATOS_FIN DATE) 
ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.OpenCSVSerde'
WITH SERDEPROPERTIES ("separatorChar" = ";", 'quoteChar' = '\"') TBLPROPERTIES ('skip.header.line.count'='1');

LOAD DATA LOCAL INPATH '/home/cloudera/shakespear/estadisticas202212.csv' INTO TABLE student_copy;

CREATE TABLE IF NOT EXISTS padron_txt_2 
AS SELECT COD_DISTRITO, TRIM(DESC_DISTRITO) AS DESC_DISTRITO, COD_DIST_BARRIO, TRIM(DESC_BARRIO) AS DESC_BARRIO, COD_BARRIO, COD_DIST_SECCION,
COD_SECCION, COD_EDAD_INT, ESPANOLESHOMBRES, ESPANOLESMUJERES, extranjeroshombres, extranjerosmujeres, fx_carga, fx_datos_ini, fx_datos_fin 
FROM padron_txt

select * from padron_txt where COD_DISTRITO = "" or DESC_DISTRITO = "" or COD_DIST_BARRIO = "" or COD_BARRIO = "" or 
COD_DIST_SECCION = "" or COD_SECCION = "" or COD_EDAD_INT = "" or fx_carga = "" or fx_datos_ini = "" or fx_datos_fin = ""

INSERT OVERWRITE TABLE padron_txt
SELECT COD_DISTRITO, DESC_DISTRITO, COD_DIST_BARRIO, DESC_BARRIO, COD_BARRIO, COD_DIST_SECCION,
COD_SECCION, COD_EDAD_INT, CASE WHEN LENGTH(ESPANOLESHOMBRES) = 0 THEN "0" ELSE ESPANOLESHOMBRES END AS ESPANOLESHOMBRES,
CASE WHEN LENGTH(ESPANOLESMUJERES) = 0 THEN "0" ELSE ESPANOLESMUJERES END AS ESPANOLESMUJERES,
CASE WHEN LENGTH(extranjeroshombres) = 0 THEN "0" ELSE extranjeroshombres END AS extranjeroshombres,
CASE WHEN LENGTH(extranjerosmujeres) = 0 THEN "0" ELSE extranjerosmujeres END AS extranjerosmujeres,
fx_carga, fx_datos_ini, fx_datos_fin 
FROM padron_txt